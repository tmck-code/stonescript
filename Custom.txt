// import all shared strategies & logging utility
import SS/Log
var gameEngine = import SS/Actions/GameEngine

// increase loot
func LootStar()
  ?pickup.distance < 10
    equipL star
    equipR tri
    >o-6,3,#yellow,Loot!!
    return true
  return false

// auto-use potion when hp is low
func AutoPotion()
  ?hp < 45
    activate potion

// Use the "right" key to trigger the blade of the fallen god
func ListenForBladeTrigger()
  ?key = rightBegin
    >0,10,Triggered Blade!
    equip blade
    activate R
    return true
  return false

func canUseBlade()
  return item.GetCooldown("blade") <= 0

// cannot be interrupted, doesn't need a cooldown check
func useBlade()
  equip blade
  activate R
  return

/* Checks if Blade of the Fallen God
can be used in 2 screens of distance,
according to a certain screen index. */
func canUseBladeDS(nScreen)
  return canUseBlade()
  ^& screen.i = nScreen

var slideCount = 0 // counter to give screen.Next() time to slide
func useBladeDS()
  ?slideCount = 0
    screen.Next()
    slideCount = 20

  :?slideCount > 0
    slideCount--

    ?slideCount = 0
      useBlade()
      screen.ResetOffset()
      return


// toggle remote cache
gameEngine.ToggleRemoteCache()
// toggle "Attack Animation Cancel (AAC)"
gameEngine.ToggleCancelAttackAnimation()

?canUseBladeDS(3)
  useBladeDS()

var strats = import SS/Strats

// strats.UseWeaponIfDist("fissure", 18)
?foe.count >= 8
  strats.MaskOfTheLost()

// enable auto-heal (via potions)
AutoPotion()
// enable bonus loot with star stone
LootStar()
// trigger blade of the fallen god by pressing "right"
ListenForBladeTrigger()

// import all location-specific strategies
import SS/Locations/RockyPlateau
import SS/Locations/DeadwoodValley
import SS/Locations/CausticCaves
import SS/Locations/FungusForest
import SS/Locations/HauntedHalls
import SS/Locations/BoilingMine
import SS/Locations/IcyRidge
import SS/Locations/Temple
